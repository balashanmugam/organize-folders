# Code to clean up the downloads folder
import os
import sys
import shutil


def createDirectory(folder, path):
    directory = path + folder + "/"
    if not os.path.exists(directory):
        os.mkdir(directory)
        print(directory + " Created successfully.")

    return directory


def move(path, name, directoryType):
    src = path + name
    dest = directoryType + '/' + name
    shutil.move(src, dest)
    logString = "Moved " + name + " to " + directoryType
    print(logString)


def analyzeFolder(folderPath):
    return


def cleanup(rootDir):
    # ignore folders for now
    files = os.listdir(rootDir)

    imagesDir = createDirectory("Images", rootDir)
    docsDir = createDirectory("Documents", rootDir)
    videoDir = createDirectory("Videos", rootDir)
    zipDir = createDirectory("Archives", rootDir)
    dmgDir = createDirectory("Installer", rootDir)
    codeDir = createDirectory('SourceCode', rootDir)

    for name in files:
        if '.png' in name or '.jpg' in name or '.tiff' in name or '.jpeg' in name:
            move(rootDir, name, imagesDir)
        elif '.pdf' in name or '.docx' in name or '.pptx' in name:
            move(rootDir, name, docsDir)
        elif '.mp4' in name or '.mkv' in name:
            move(rootDir, name, videoDir)
        elif '.zip' in name or '.rar' in name or '.tar' in name or '.7z' in name:
            move(rootDir, name, zipDir)
        elif '.dmg' in name or '.pkg' in name:
            move(rootDir, name, dmgDir)
        elif '.m' in name or '.sh' in name or '.py' in name:
            move(rootDir, name, codeDir)
        elif '.psd' in name or '.sketch' in name:
            move(rootDir, name, docsDir)


def main(rootDir):
    if(rootDir == 'pwd'):
        rootDir = os.getcwd()
    elif(rootDir == 'Downloads'):  # most messy folder
        rootDir = "/Users/balashanmugam/Downloads/"
    if not os.path.exists(rootDir):
        print("Error: Path not found. " + rootDir + " is invalid!")
        print("Terminating program")
        exit()

    cleanup(rootDir)

    print("Cleanup done successfully.")


if __name__ == "__main__":
    try:
        rootDir = sys.argv[1]
    except Exception:
        print("Try with arguments `Downloads`")
        exit()

    main(rootDir)
